<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus Mods è·³è½¬å™¨</title>
    
    <!-- ç½‘é¡µå›¾æ ‡ -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><defs><linearGradient id='grad1' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' style='stop-color:%23667eea'/><stop offset='100%25' style='stop-color:%23764ba2'/></linearGradient></defs><circle cx='32' cy='32' r='30' fill='url(%23grad1)'/><path d='M24 18 L24 46 L20 46 L20 18 Z M24 18 L40 18 L40 22 L24 22 Z M20 42 L32 42 Q40 42 40 34 Q40 26 32 26 L28 26 L28 30 L32 30 Q36 30 36 34 Q36 38 32 38 L20 38 Z' fill='white'/></svg>" type="image/svg+xml">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><defs><linearGradient id='grad1' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' style='stop-color:%23667eea'/><stop offset='100%25' style='stop-color:%23764ba2'/></linearGradient></defs><circle cx='32' cy='32' r='30' fill='url(%23grad1)'/><path d='M24 18 L24 46 L20 46 L20 18 Z M24 18 L40 18 L40 22 L24 22 Z M20 42 L32 42 Q40 42 40 34 Q40 26 32 26 L28 26 L28 30 L32 30 Q36 30 36 34 Q36 38 32 38 L20 38 Z' fill='white'/></svg>">
    <meta name="theme-color" content="#667eea">
    
    <script src="translations.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', Tahoma, Arial, sans-serif;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            max-width: 500px;
            width: 100%;
            transform: translateY(-80px);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .container:hover {
            transform: translateY(-85px);
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.3);
        }

        h1 {
            color: #333;
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            animation: titleGlow 3s ease-in-out infinite alternate;
        }

        @keyframes titleGlow {
            0% {
                filter: brightness(1);
            }

            100% {
                filter: brightness(1.2);
            }
        }

        .input-group {
            margin-bottom: 25px;
            position: relative;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
            font-size: 1.1em;
        }

        input[type="text"] {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid transparent;
            border-radius: 12px;
            box-sizing: border-box;
            font-size: 16px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        input[type="text"]:focus {
            outline: none;
            border: 2px solid #667eea;
            background: rgba(255, 255, 255, 1);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        #search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            max-height: 200px;
            overflow-y: auto;
            border-radius: 12px;
            margin-top: 8px;
            display: none;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            animation: slideIn 0.3s ease-out;
            z-index: 1000;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .game-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .game-item:last-child {
            border-bottom: none;
        }

        .game-item:hover {
            background: linear-gradient(90deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            transform: translateX(5px);
        }

        .game-item.recent-game {
            opacity: 0.9;
        }

        .game-item.recent-game:hover {
            opacity: 1;
            background: linear-gradient(90deg, rgba(102, 126, 234, 0.08), rgba(118, 75, 162, 0.08));
        }

        .recent-games-header {
            position: sticky;
            top: 0;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            z-index: 10;
        }

        button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 18px 30px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
        }

        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        button:hover::before {
            left: 100%;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
            background: linear-gradient(45deg, #5a6fd8, #6a4c93);
        }

        button:active {
            transform: translateY(-1px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* æ»šåŠ¨æ¡æ ·å¼ */
        #search-results::-webkit-scrollbar {
            width: 6px;
        }

        #search-results::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 3px;
        }

        #search-results::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 3px;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 480px) {
            .container {
                padding: 20px;
                margin: 10px;
            }

            h1 {
                font-size: 2em;
            }

            input[type="text"] {
                padding: 12px 16px;
                font-size: 14px;
            }

            button {
                padding: 15px 25px;
                font-size: 16px;
            }

            /* æ‰‹æœºç«¯æŒ‰é’®ç»„è°ƒæ•´ */
            div[style*="top: 20px; right: 20px"] {
                top: 15px !important;
                right: 15px !important;
                gap: 10px !important;
            }

            div[style*="top: 20px; left: 20px"] {
                top: 15px !important;
                left: 15px !important;
            }

            #refresh-icon,
            #settings-icon,
            #clear-history-icon,
            #github-icon {
                width: 45px !important;
                height: 45px !important;
            }

            #refresh-icon span,
            #settings-icon span,
            #clear-history-icon span {
                font-size: 18px !important;
            }

            #github-icon svg {
                width: 20px !important;
                height: 20px !important;
            }

            /* æ¨¡æ€æ¡†ç§»åŠ¨ç«¯é€‚é… */
            .modal-content {
                margin: 10% auto;
                padding: 20px;
                width: 95%;
                max-width: none;
            }

            .modal-title {
                font-size: 1.5em;
            }

            .modal-footer {
                flex-direction: column;
                gap: 10px;
            }

            .modal-button {
                width: 100%;
            }

            .form-input {
                padding: 12px 16px;
                font-size: 16px;
                /* é˜²æ­¢iOSè‡ªåŠ¨ç¼©æ”¾ */
            }

            .help-text {
                font-size: 13px;
            }
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, .3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* ç½‘é¡µå³ä¸Šè§’åˆ·æ–°å›¾æ ‡æ ·å¼ */
        #refresh-icon {
            opacity: 0;
            animation: fadeInIcon 1s ease-out 2s forwards;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        @keyframes fadeInIcon {
            to {
                opacity: 1;
            }
        }

        #refresh-icon:hover {
            transform: scale(1.15);
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.5);
            border-color: rgba(255, 255, 255, 0.4);
        }

        #refresh-icon:hover span {
            transform: rotate(180deg);
        }

        #refresh-icon.refreshing span {
            animation: spin 1s linear infinite;
        }

        #refresh-icon.disabled {
            opacity: 0.4;
            cursor: not-allowed;
            pointer-events: none;
        }

        /* åˆ·æ–°å›¾æ ‡çš„è„‰å†²æ•ˆæœ */
        #refresh-icon::before {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            border-radius: 50%;
            border: 2px solid rgba(102, 126, 234, 0.3);
            animation: pulse 2s infinite;
            opacity: 0;
        }

        @keyframes pulse {
            0% {
                transform: scale(0.8);
                opacity: 1;
            }

            100% {
                transform: scale(1.2);
                opacity: 0;
            }
        }

        /* æ¸…é™¤å†å²æŒ‰é’®æ ·å¼ */
        #clear-history-icon {
            opacity: 0;
            animation: fadeInIcon 1s ease-out 2s forwards;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        #clear-history-icon:hover {
            transform: scale(1.15);
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.5);
            border-color: rgba(255, 255, 255, 0.4);
        }

        #clear-history-icon:hover span {
            transform: rotate(10deg) scale(1.1);
        }

        /* è®¾ç½®æŒ‰é’®æ ·å¼ */
        #settings-icon {
            opacity: 0;
            animation: fadeInIcon 1s ease-out 2s forwards;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        #settings-icon:hover {
            transform: scale(1.15);
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.5);
            border-color: rgba(255, 255, 255, 0.4);
        }

        #settings-icon:hover span {
            transform: rotate(30deg);
        }

        /* GitHubæŒ‰é’®æ ·å¼ */
        #github-icon {
            opacity: 0;
            animation: fadeInIcon 1s ease-out 2s forwards;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        #github-icon:hover {
            transform: scale(1.15);
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.5);
            border-color: rgba(255, 255, 255, 0.4);
        }

        #github-icon:hover svg {
            transform: rotate(360deg);
        }

        /* API Key çŠ¶æ€æŒ‡ç¤ºå™¨ */
        #settings-icon::after {
            content: '';
            position: absolute;
            top: -2px;
            right: -2px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            border: 2px solid white;
            transition: all 0.3s ease;
        }

        #settings-icon.has-api::after {
            background: #4CAF50;
        }

        #settings-icon.no-api::after {
            background: #ff9800;
            animation: blink 2s infinite;
        }

        @keyframes blink {

            0%,
            50% {
                opacity: 1;
            }

            51%,
            100% {
                opacity: 0.5;
            }
        }

        /* API key æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            animation: modalFadeIn 0.3s ease-out;
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            margin: 5% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            border-bottom: 2px solid rgba(102, 126, 234, 0.2);
            padding-bottom: 15px;
        }

        .modal-title {
            font-size: 1.8em;
            font-weight: 700;
            background: linear-gradient(45deg, #667eea, #764ba2);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .close-button {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            border: none;
            background: none;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-button:hover {
            color: #667eea;
            background: rgba(102, 126, 234, 0.1);
            transform: rotate(90deg);
        }

        .modal-body {
            margin-bottom: 25px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 1.1em;
        }

        .form-input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid transparent;
            border-radius: 12px;
            font-size: 16px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            box-sizing: border-box;
        }

        .form-input:focus {
            outline: none;
            border: 2px solid #667eea;
            background: rgba(255, 255, 255, 1);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .help-text {
            font-size: 14px;
            color: #666;
            margin-top: 8px;
            line-height: 1.4;
        }

        .help-text a {
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
        }

        .help-text a:hover {
            text-decoration: underline;
        }

        .modal-footer {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }

        .modal-button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            min-width: 100px;
        }

        .modal-button.primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .modal-button.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .modal-button.secondary {
            background: rgba(255, 255, 255, 0.8);
            color: #333;
            border: 2px solid rgba(102, 126, 234, 0.3);
        }

        .modal-button.secondary:hover {
            background: rgba(102, 126, 234, 0.1);
            border-color: #667eea;
        }

        /* API Key çŠ¶æ€æŒ‡ç¤ºå™¨ */
        .api-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-top: 10px;
        }

        .api-status.valid {
            background: rgba(76, 175, 80, 0.1);
            color: #4CAF50;
            border: 1px solid rgba(76, 175, 80, 0.3);
        }

        .api-status.invalid {
            background: rgba(244, 67, 54, 0.1);
            color: #f44336;
            border: 1px solid rgba(244, 67, 54, 0.3);
        }

        .api-status.none {
            background: rgba(255, 152, 0, 0.1);
            color: #ff9800;
            border: 1px solid rgba(255, 152, 0, 0.3);
        }
    </style>
</head>

<body>
    <!-- ç½‘é¡µå·¦ä¸Šè§’GitHubæŒ‰é’® -->
    <div style="position: fixed; top: 20px; left: 20px; z-index: 1000;">
        <div id="github-icon"
            style="width: 50px; height: 50px; border-radius: 50%; background: linear-gradient(45deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 6px 25px rgba(102,126,234,0.4); backdrop-filter: blur(10px); opacity: 0; animation: fadeInIcon 1s ease-out 2s forwards; border: 2px solid rgba(255, 255, 255, 0.2);"
            title="è®¿é—® GitHub é¡¹ç›®é¡µé¢">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="white" style="transition: transform 0.3s ease;">
                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
            </svg>
        </div>
    </div>

    <!-- ç½‘é¡µå³ä¸Šè§’æŒ‰é’®ç»„ -->
    <div style="position: fixed; top: 20px; right: 20px; display: flex; gap: 15px; z-index: 1000;">
        <!-- æ¸…é™¤å†å²æŒ‰é’® -->
        <div id="clear-history-icon"
            style="width: 50px; height: 50px; border-radius: 50%; background: linear-gradient(45deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 6px 25px rgba(102,126,234,0.4); backdrop-filter: blur(10px);"
            title="æ¸…é™¤æœç´¢å†å²è®°å½•">
            <span style="color: white; font-size: 20px; transition: transform 0.3s ease;">ğŸ—‘ï¸</span>
        </div>

        <!-- è®¾ç½®æŒ‰é’® -->
        <div id="settings-icon"
            style="width: 50px; height: 50px; border-radius: 50%; background: linear-gradient(45deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 6px 25px rgba(102,126,234,0.4); backdrop-filter: blur(10px);"
            title="API Key è®¾ç½®ï¼ˆé…ç½® Nexus Mods API Keyï¼‰">
            <span style="color: white; font-size: 20px; transition: transform 0.3s ease;">âš™ï¸</span>
        </div>

        <!-- åˆ·æ–°æŒ‰é’® -->
        <div id="refresh-icon"
            style="width: 50px; height: 50px; border-radius: 50%; background: linear-gradient(45deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 6px 25px rgba(102,126,234,0.4); backdrop-filter: blur(10px);"
            title="å¼ºåˆ¶åˆ·æ–°æ¸¸æˆåˆ—è¡¨ç¼“å­˜ï¼ˆæ¸…é™¤æœ¬åœ°ç¼“å­˜å¹¶é‡æ–°åŠ è½½ï¼‰">
            <span style="color: white; font-size: 20px; transition: transform 0.3s ease;">ğŸ”„</span>
        </div>
    </div>

    <div class="container">
        <h1>Nexus Mods è·³è½¬å™¨</h1>

        <div class="input-group">
            <label for="game-search">æ¸¸æˆåç§°ï¼š</label>
            <input type="text" id="game-search" placeholder="æ­£åœ¨åŠ è½½æ¸¸æˆåˆ—è¡¨..." autocomplete="off" disabled>
            <div id="search-results"></div>
            <div id="loading-indicator" style="text-align: center; margin-top: 10px; color: #667eea;">
                <span class="loading"></span> æ­£åœ¨ä» Nexus Mods API åŠ è½½æ¸¸æˆåˆ—è¡¨...
            </div>
        </div>

        <div class="input-group">
            <label for="mod-id">Mod IDï¼š</label>
            <input type="text" id="mod-id" placeholder="è¾“å…¥Mod IDï¼ˆæ•°å­—ï¼‰">
        </div>

        <button id="go-button">è·³è½¬åˆ°Modé¡µé¢</button>
    </div>

    <!-- API Key è®¾ç½®æ¨¡æ€æ¡† -->
    <div id="api-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">API Key è®¾ç½®</h2>
                <button class="close-button" id="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="api-key-input" class="form-label">Nexus Mods API Key</label>
                    <input type="password" id="api-key-input" class="form-input" placeholder="è¾“å…¥æ‚¨çš„ Nexus Mods API Key"
                        autocomplete="off" spellcheck="false" data-lpignore="true" data-form-type="password">
                    <div class="help-text">
                        ğŸ”‘ API Key ç”¨äºè®¿é—® Nexus Mods çš„æ¸¸æˆåˆ—è¡¨æ•°æ®<br>
                        ğŸ“ æ‚¨å¯ä»¥åœ¨ <a href="https://www.nexusmods.com/users/myaccount?tab=api" target="_blank">Nexus Mods
                            è´¦æˆ·è®¾ç½®</a> ä¸­è·å– Personal API Key<br>
                        ğŸ’¾ API Key å°†å®‰å…¨åœ°å­˜å‚¨åœ¨æ‚¨çš„æµè§ˆå™¨æœ¬åœ°ï¼Œä¸ä¼šå‘é€åˆ°ä»»ä½•æœåŠ¡å™¨
                    </div>
                </div>

                <!-- API Key çŠ¶æ€ -->
                <div id="api-key-status"></div>
            </div>
            <div class="modal-footer">
                <button class="modal-button secondary" id="clear-api-key">æ¸…é™¤</button>
                <button class="modal-button secondary" id="cancel-modal">å–æ¶ˆ</button>
                <button class="modal-button primary" id="save-api-key">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <script>
        // Nexus Mods API é…ç½®
        const NEXUS_API_BASE = 'https://api.nexusmods.com/v1';
        const API_KEY_STORAGE_KEY = 'nexus_api_key';

        // æ¸¸æˆæ•°æ® - å°†ä»APIåŠ¨æ€åŠ è½½
        let games = [];

        // æ¸¸æˆæ˜ å°„è¡¨å’Œå¤‡ç”¨æ¸¸æˆåˆ—è¡¨å·²ç§»è‡³ game-translations.js æ–‡ä»¶ä¸­

        // ç¼“å­˜é…ç½®
        const CACHE_CONFIG = {
            GAMES_CACHE_KEY: 'nexus_games_cache',
            CACHE_DURATION: 24 * 60 * 60 * 1000, // 24å°æ—¶ç¼“å­˜æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
            CACHE_VERSION: '1.0' // ç¼“å­˜ç‰ˆæœ¬ï¼Œç”¨äºå¼ºåˆ¶æ›´æ–°
        };

        // å†å²è®°å½•é…ç½®
        const HISTORY_CONFIG = {
            RECENT_GAMES_KEY: 'nexus_recent_games',
            MAX_RECENT_GAMES: 10 // æœ€å¤§ä¿å­˜10ä¸ªæœ€è¿‘é€‰ä¸­çš„æ¸¸æˆ
        };

        // ç®€å•çš„åŠ å¯†/è§£å¯†å‡½æ•°
        function simpleEncrypt(text) {
            if (!text) return '';
            let result = '';
            const key = 'NexusModsJumper2024';
            for (let i = 0; i < text.length; i++) {
                result += String.fromCharCode(text.charCodeAt(i) ^ key.charCodeAt(i % key.length));
            }
            return btoa(result); // Base64ç¼–ç 
        }

        function simpleDecrypt(encrypted) {
            if (!encrypted) return '';
            try {
                const text = atob(encrypted); // Base64è§£ç 
                let result = '';
                const key = 'NexusModsJumper2024';
                for (let i = 0; i < text.length; i++) {
                    result += String.fromCharCode(text.charCodeAt(i) ^ key.charCodeAt(i % key.length));
                }
                return result;
            } catch (error) {
                return '';
            }
        }

        // API Key ç®¡ç†å‡½æ•° - ç°åœ¨ä½¿ç”¨åŠ å¯†å­˜å‚¨
        function getApiKey() {
            try {
                const encrypted = localStorage.getItem(API_KEY_STORAGE_KEY);
                return simpleDecrypt(encrypted);
            } catch (error) {
                return null;
            }
        }

        function setApiKey(apiKey) {
            try {
                if (apiKey && apiKey.trim()) {
                    const encrypted = simpleEncrypt(apiKey.trim());
                    localStorage.setItem(API_KEY_STORAGE_KEY, encrypted);
                    return true;
                } else {
                    localStorage.removeItem(API_KEY_STORAGE_KEY);
                    return false;
                }
            } catch (error) {
                return false;
            }
        }

        function clearApiKey() {
            try {
                localStorage.removeItem(API_KEY_STORAGE_KEY);
                return true;
            } catch (error) {
                return false;
            }
        }

        function hasApiKey() {
            const apiKey = getApiKey();
            return apiKey && apiKey.trim().length > 0;
        }

        // æœ€è¿‘æ¸¸æˆå†å²ç®¡ç†
        function getRecentGames() {
            try {
                const recentGamesData = localStorage.getItem(HISTORY_CONFIG.RECENT_GAMES_KEY);
                return recentGamesData ? JSON.parse(recentGamesData) : [];
            } catch (error) {
                return [];
            }
        }

        function addRecentGame(game) {
            try {
                let recentGames = getRecentGames();

                // ç§»é™¤å·²å­˜åœ¨çš„ç›¸åŒæ¸¸æˆï¼ˆé¿å…é‡å¤ï¼‰
                recentGames = recentGames.filter(g => g.slug !== game.slug);

                // æ·»åŠ åˆ°å¼€å¤´
                recentGames.unshift({
                    name: game.name,
                    chinese: game.chinese,
                    slug: game.slug,
                    downloads: game.downloads,
                    files: game.files,
                    timestamp: new Date().getTime()
                });

                // é™åˆ¶æœ€å¤§æ•°é‡
                if (recentGames.length > HISTORY_CONFIG.MAX_RECENT_GAMES) {
                    recentGames = recentGames.slice(0, HISTORY_CONFIG.MAX_RECENT_GAMES);
                }

                localStorage.setItem(HISTORY_CONFIG.RECENT_GAMES_KEY, JSON.stringify(recentGames));
                return true;
            } catch (error) {
                return false;
            }
        }

        function clearRecentGames() {
            try {
                localStorage.removeItem(HISTORY_CONFIG.RECENT_GAMES_KEY);
                return true;
            } catch (error) {
                return false;
            }
        }

        // æ£€æŸ¥ç¼“å­˜æ˜¯å¦æœ‰æ•ˆ
        function isCacheValid() {
            try {
                const cachedData = localStorage.getItem(CACHE_CONFIG.GAMES_CACHE_KEY);
                if (!cachedData) return false;

                const cache = JSON.parse(cachedData);

                // æ£€æŸ¥ç¼“å­˜ç‰ˆæœ¬
                if (cache.version !== CACHE_CONFIG.CACHE_VERSION) {
                    return false;
                }

                // æ£€æŸ¥ç¼“å­˜æ—¶é—´
                const now = new Date().getTime();
                const cacheAge = now - cache.timestamp;

                if (cacheAge > CACHE_CONFIG.CACHE_DURATION) {
                    return false;
                }

                return true;
            } catch (error) {
                return false;
            }
        }

        // ä»ç¼“å­˜åŠ è½½æ¸¸æˆåˆ—è¡¨
        function loadGamesFromCache() {
            try {
                const cachedData = localStorage.getItem(CACHE_CONFIG.GAMES_CACHE_KEY);
                if (!cachedData) return null;

                const cache = JSON.parse(cachedData);
                return cache.games;
            } catch (error) {
                return null;
            }
        }

        // ä¿å­˜æ¸¸æˆåˆ—è¡¨åˆ°ç¼“å­˜
        function saveGamesToCache(gamesList) {
            try {
                const cacheData = {
                    games: gamesList,
                    timestamp: new Date().getTime(),
                    version: CACHE_CONFIG.CACHE_VERSION
                };

                localStorage.setItem(CACHE_CONFIG.GAMES_CACHE_KEY, JSON.stringify(cacheData));
            } catch (error) {
                // é™é»˜å¤„ç†ç¼“å­˜ä¿å­˜å¤±è´¥
            }
        }

        // æ¸…é™¤æ¸¸æˆåˆ—è¡¨ç¼“å­˜
        function clearGamesCache() {
            try {
                localStorage.removeItem(CACHE_CONFIG.GAMES_CACHE_KEY);
            } catch (error) {
                // é™é»˜å¤„ç†ç¼“å­˜æ¸…é™¤å¤±è´¥
            }
        }

        // ä» Nexus Mods API è·å–æ¸¸æˆåˆ—è¡¨ï¼ˆå¸¦ç¼“å­˜åŠŸèƒ½ï¼‰
        async function fetchGamesFromAPI(forceRefresh = false) {
            const gameSearchInput = document.getElementById('game-search');
            const loadingIndicator = document.getElementById('loading-indicator');
            const refreshButton = document.getElementById('refresh-games');

            // æ£€æŸ¥æ˜¯å¦éœ€è¦å¼ºåˆ¶åˆ·æ–°æˆ–ç¼“å­˜æ— æ•ˆ
            if (!forceRefresh && isCacheValid()) {
                const cachedGames = loadGamesFromCache();

                if (cachedGames && cachedGames.length > 0) {
                    // å¯¹ç¼“å­˜çš„æ¸¸æˆé‡æ–°åº”ç”¨ç¿»è¯‘ï¼ˆä»¥é˜²ç¿»è¯‘è¡¨æ›´æ–°ï¼‰
                    games = cachedGames.map(game => ({
                        ...game,
                        chinese: gameTranslations[game.name] || game.chinese || game.name
                    }));

                    // ç¼“å­˜åŠ è½½æˆåŠŸ
                    gameSearchInput.disabled = false;
                    gameSearchInput.placeholder = 'è¾“å…¥æ¸¸æˆä¸­æ–‡åæˆ–è‹±æ–‡å...';
                    if (loadingIndicator) {
                        loadingIndicator.style.display = 'none';
                    }

                    // æ˜¾ç¤ºåˆ·æ–°å›¾æ ‡
                    const refreshIcon = document.getElementById('refresh-icon');
                    if (refreshIcon) {
                        refreshIcon.style.opacity = '1';
                    }

                    showNotification(`å·²ä»ç¼“å­˜åŠ è½½ ${games.length} ä¸ªæ¸¸æˆ ğŸ’¾`, 'info');
                    return;
                }
            }

            try {
                showNotification(forceRefresh ? 'æ­£åœ¨åˆ·æ–°æ¸¸æˆåˆ—è¡¨...' : 'æ­£åœ¨åŠ è½½æ¸¸æˆåˆ—è¡¨...', 'info');

                // å°è¯•ç›´æ¥è°ƒç”¨API
                let response;
                let apiUrl = `${NEXUS_API_BASE}/games.json`;

                try {
                    const apiKey = getApiKey();
                    if (!apiKey) {
                        throw new Error('æœªè®¾ç½®API Keyï¼Œè¯·å…ˆåœ¨è®¾ç½®ä¸­é…ç½®æ‚¨çš„ Nexus Mods API Key');
                    }

                    response = await fetch(apiUrl, {
                        method: 'GET',
                        headers: {
                            'apikey': apiKey,
                            'Content-Type': 'application/json'
                        }
                    });
                } catch (corsError) {
                    // ç”±äºCORSé™åˆ¶ï¼Œæµè§ˆå™¨æ— æ³•ç›´æ¥è°ƒç”¨Nexus API
                    throw new Error('æµè§ˆå™¨CORSé™åˆ¶ï¼Œæ— æ³•ç›´æ¥è°ƒç”¨Nexus APIã€‚éœ€è¦åç«¯ä»£ç†æˆ–æµè§ˆå™¨æ‰©å±•ã€‚');
                }

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const apiGames = await response.json();

                // è½¬æ¢APIè¿”å›çš„æ•°æ®æ ¼å¼ä¸ºæˆ‘ä»¬éœ€è¦çš„æ ¼å¼ï¼Œå¹¶æ·»åŠ ä¸­æ–‡ç¿»è¯‘
                games = apiGames.map(game => {
                    // æŸ¥æ‰¾ä¸­æ–‡ç¿»è¯‘ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨è‹±æ–‡å
                    const chineseName = gameTranslations[game.name] || game.name;

                    return {
                        name: game.name,
                        chinese: chineseName,
                        slug: game.domain_name,
                        categories: game.categories || 0,
                        downloads: game.downloads || 0,
                        files: game.file_count || 0
                    };
                });

                // æŒ‰ä¸‹è½½é‡æ’åºï¼Œçƒ­é—¨æ¸¸æˆåœ¨å‰
                games.sort((a, b) => b.downloads - a.downloads);

                // ä¿å­˜åˆ°ç¼“å­˜
                saveGamesToCache(games);

                showNotification(`æˆåŠŸåŠ è½½ ${games.length} ä¸ªæ¸¸æˆ ğŸ”„`, 'success');

            } catch (error) {
                // æ£€æŸ¥æ˜¯å¦æ˜¯API Keyç›¸å…³çš„é”™è¯¯
                if (error.message.includes('API Key') || error.message.includes('401') || error.message.includes('403')) {
                    showNotification('API Key æ— æ•ˆæˆ–æœªè®¾ç½®ï¼Œè¯·ç‚¹å‡»è®¾ç½®æŒ‰é’®é…ç½®', 'warning');
                }

                // APIåŠ è½½å¤±è´¥ï¼Œå°è¯•ä»ç¼“å­˜åŠ è½½ï¼ˆå³ä½¿è¿‡æœŸï¼‰
                const cachedGames = loadGamesFromCache();
                if (cachedGames && cachedGames.length > 0) {
                    // å¯¹ç¼“å­˜çš„æ¸¸æˆé‡æ–°åº”ç”¨ç¿»è¯‘ï¼ˆä»¥é˜²ç¿»è¯‘è¡¨æ›´æ–°ï¼‰
                    games = cachedGames.map(game => ({
                        ...game,
                        chinese: gameTranslations[game.name] || game.chinese || game.name
                    }));
                    showNotification('APIåŠ è½½å¤±è´¥ï¼Œä½¿ç”¨ç¼“å­˜æ•°æ®', 'warning');
                } else {
                    // ç¼“å­˜ä¹Ÿæ²¡æœ‰ï¼Œä½¿ç”¨å¤‡ç”¨æ¸¸æˆåˆ—è¡¨
                    games = fallbackGames.map(game => ({
                        ...game,
                        chinese: gameTranslations[game.name] || game.chinese || game.name
                    }));
                    showNotification('APIåŠ è½½å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ¸¸æˆåˆ—è¡¨', 'warning');
                }
            } finally {
                // æ— è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½è¦å¯ç”¨æœç´¢æ¡†å¹¶éšè—åŠ è½½æŒ‡ç¤ºå™¨
                gameSearchInput.disabled = false;
                gameSearchInput.placeholder = 'è¾“å…¥æ¸¸æˆä¸­æ–‡åæˆ–è‹±æ–‡å...';
                if (loadingIndicator) {
                    loadingIndicator.style.display = 'none';
                }

                // æ˜¾ç¤ºå¹¶å¯ç”¨åˆ·æ–°å›¾æ ‡
                const refreshIcon = document.getElementById('refresh-icon');
                if (refreshIcon) {
                    refreshIcon.style.opacity = '1';
                    refreshIcon.classList.remove('refreshing', 'disabled');
                }
            }
        }



        // DOM å…ƒç´ 
        const gameSearchInput = document.getElementById('game-search');
        const searchResults = document.getElementById('search-results');
        const modIdInput = document.getElementById('mod-id');
        const goButton = document.getElementById('go-button');

        let selectedGame = null;

        // æ˜¾ç¤ºæœ€è¿‘æ¸¸æˆå†å²
        function showRecentGames() {
            const recentGames = getRecentGames();

            if (recentGames.length === 0) {
                searchResults.style.display = 'none';
                return;
            }

            searchResults.innerHTML = '';

            recentGames.forEach(game => {
                const div = document.createElement('div');
                div.className = 'game-item recent-game';
                div.style.paddingLeft = '25px'; // ç¨å¾®ç¼©è¿›è¡¨ç¤ºè¿™æ˜¯å†å²è®°å½•

                const gameInfo = document.createElement('div');
                gameInfo.style.cssText = 'display: flex; justify-content: space-between; align-items: center;';

                const nameDiv = document.createElement('div');
                const displayName = game.chinese === game.name ? game.name : game.chinese;
                nameDiv.innerHTML = `<span style="color: #888;">ğŸ•’</span> ${displayName}`;
                nameDiv.style.fontWeight = '500';

                const statsDiv = document.createElement('div');
                statsDiv.style.cssText = 'font-size: 12px; color: #888; text-align: right;';

                if (game.downloads || game.files) {
                    const parts = [];
                    if (game.downloads) parts.push(`ğŸ“¥ ${formatNumber(game.downloads)}`);
                    if (game.files) parts.push(`ğŸ“„ ${formatNumber(game.files)}`);
                    statsDiv.textContent = parts.join(' | ');
                }

                gameInfo.appendChild(nameDiv);
                if (statsDiv.textContent) gameInfo.appendChild(statsDiv);

                div.appendChild(gameInfo);

                div.addEventListener('click', function () {
                    selectedGame = game;
                    const displayName = game.chinese === game.name ? game.name : game.chinese;
                    gameSearchInput.value = displayName;
                    searchResults.style.display = 'none';

                    // æ›´æ–°æŒ‰é’®æ–‡æœ¬
                    if (modIdInput.value.trim()) {
                        goButton.style.background = 'linear-gradient(45deg, #4CAF50, #45a049)';
                        goButton.textContent = `è·³è½¬åˆ° ${displayName}`;
                    }
                });

                searchResults.appendChild(div);
            });

            searchResults.style.display = 'block';
        }

        // æœç´¢æ¡†ç‚¹å‡»äº‹ä»¶ - æ¸…ç©ºæœç´¢æ¡†å¹¶æ˜¾ç¤ºæœ€è¿‘æ¸¸æˆ
        gameSearchInput.addEventListener('focus', function () {
            // æ¸…ç©ºæœç´¢æ¡†
            this.value = '';
            // æ¸…ç©ºå½“å‰é€‰ä¸­çš„æ¸¸æˆ
            selectedGame = null;
            // é‡ç½®æŒ‰é’®çŠ¶æ€
            goButton.style.background = 'linear-gradient(45deg, #667eea, #764ba2)';
            goButton.textContent = 'è·³è½¬åˆ°Modé¡µé¢';
            // æ˜¾ç¤ºæœ€è¿‘æ¸¸æˆ
            showRecentGames();
        });

        // é«˜çº§æœç´¢åŠŸèƒ½ - æ”¯æŒä¸­è‹±æ–‡æ¨¡ç³ŠåŒ¹é…
        gameSearchInput.addEventListener('input', function () {
            const searchTerm = this.value.toLowerCase().trim();

            if (searchTerm.length < 1) {
                showRecentGames(); // å½“æœç´¢æ¡†ä¸ºç©ºæ—¶æ˜¾ç¤ºæœ€è¿‘æ¸¸æˆ
                return;
            }



            // ç­›é€‰åŒ¹é…çš„æ¸¸æˆ - å¤šç§åŒ¹é…ç­–ç•¥
            const matchedGames = games.filter(game => {
                const englishName = game.name.toLowerCase();
                const chineseName = game.chinese.toLowerCase();

                // 1. ç›´æ¥åŒ…å«åŒ¹é…ï¼ˆä¸­è‹±æ–‡ï¼‰
                if (englishName.includes(searchTerm) || chineseName.includes(searchTerm)) {
                    return true;
                }

                // 2. å»é™¤ç‰¹æ®Šå­—ç¬¦ååŒ¹é…
                const cleanEnglish = englishName.replace(/[:\-\s]/g, '');
                const cleanChinese = chineseName.replace(/[ï¼š\-\s]/g, '');
                const cleanSearch = searchTerm.replace(/[:\-\s]/g, '');

                if (cleanEnglish.includes(cleanSearch) || cleanChinese.includes(cleanSearch)) {
                    return true;
                }

                // 3. å•è¯åŒ¹é…ï¼ˆè‹±æ–‡ï¼‰
                const englishWords = englishName.split(/[\s\-:]/);
                const searchWords = searchTerm.split(/[\s\-:]/);

                for (const searchWord of searchWords) {
                    if (searchWord.length >= 2) { // å¿½ç•¥å¤ªçŸ­çš„è¯
                        for (const englishWord of englishWords) {
                            if (englishWord.toLowerCase().startsWith(searchWord)) {
                                return true;
                            }
                        }
                    }
                }

                // 4. ç¼©å†™åŒ¹é…ï¼ˆå¦‚gtaåŒ¹é…Grand Theft Autoï¼‰
                if (searchTerm.length >= 2) {
                    const englishInitials = englishName.match(/\b\w/g);
                    if (englishInitials && englishInitials.join('').toLowerCase().includes(searchTerm)) {
                        return true;
                    }
                }

                return false;
            });

            // æ˜¾ç¤ºæœç´¢ç»“æœ - ä¼˜åŒ–çš„ä¸­è‹±æ–‡æ˜¾ç¤º
            if (matchedGames.length > 0) {
                searchResults.innerHTML = '';

                // æŒ‰ç›¸å…³æ€§æ’åºï¼šä¼˜å…ˆæ˜¾ç¤ºæ›´åŒ¹é…çš„ç»“æœ
                matchedGames.sort((a, b) => {
                    const aScore = getMatchScore(a, searchTerm);
                    const bScore = getMatchScore(b, searchTerm);
                    if (aScore !== bScore) return bScore - aScore; // é«˜åˆ†åœ¨å‰
                    return (b.downloads || 0) - (a.downloads || 0); // ä¸‹è½½é‡é«˜çš„åœ¨å‰
                });

                matchedGames.slice(0, 20).forEach(game => { // é™åˆ¶æ˜¾ç¤ºå‰20ä¸ªç»“æœ
                    const div = document.createElement('div');
                    div.className = 'game-item';

                    // åˆ›å»ºæ¸¸æˆä¿¡æ¯HTML
                    const gameInfo = document.createElement('div');
                    gameInfo.style.cssText = 'display: flex; justify-content: space-between; align-items: center;';

                    const nameDiv = document.createElement('div');

                    // æ™ºèƒ½æ˜¾ç¤ºä¸­è‹±æ–‡åç§°
                    let displayName;
                    if (game.chinese === game.name) {
                        // æ²¡æœ‰ä¸­æ–‡è¯‘åï¼Œåªæ˜¾ç¤ºè‹±æ–‡å
                        displayName = game.name;
                    } else {
                        // æœ‰ä¸­æ–‡è¯‘åï¼Œåªæ˜¾ç¤ºä¸­æ–‡å
                        displayName = game.chinese;
                    }

                    nameDiv.innerHTML = highlightMatch(displayName, searchTerm);
                    nameDiv.style.fontWeight = '600';

                    const statsDiv = document.createElement('div');
                    statsDiv.style.cssText = 'font-size: 12px; color: #888; text-align: right;';

                    if (game.downloads || game.files) {
                        const parts = [];
                        if (game.downloads) parts.push(`ğŸ“¥ ${formatNumber(game.downloads)}`);
                        if (game.files) parts.push(`ğŸ“„ ${formatNumber(game.files)}`);
                        statsDiv.textContent = parts.join(' | ');
                    }

                    gameInfo.appendChild(nameDiv);
                    if (statsDiv.textContent) gameInfo.appendChild(statsDiv);

                    div.appendChild(gameInfo);

                    div.addEventListener('click', function () {
                        selectedGame = game;
                        // æ·»åŠ åˆ°æœ€è¿‘æ¸¸æˆå†å²
                        addRecentGame(game);

                        // é€‰æ‹©åæ˜¾ç¤ºä¸­æ–‡åï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰
                        const displayName = game.chinese === game.name ? game.name : game.chinese;
                        gameSearchInput.value = displayName;
                        searchResults.style.display = 'none';

                        // æ›´æ–°æŒ‰é’®æ–‡æœ¬
                        if (modIdInput.value.trim()) {
                            goButton.style.background = 'linear-gradient(45deg, #4CAF50, #45a049)';
                            goButton.textContent = `è·³è½¬åˆ° ${game.chinese === game.name ? game.name : game.chinese}`;
                        }
                    });
                    searchResults.appendChild(div);
                });
                searchResults.style.display = 'block';
            } else {
                // æ²¡æœ‰æ‰¾åˆ°åŒ¹é…ç»“æœï¼Œæ˜¾ç¤ºæœ€è¿‘æ¸¸æˆä½œä¸ºå»ºè®®
                const recentGames = getRecentGames();
                if (recentGames.length > 0) {
                    searchResults.innerHTML = '';

                    // æ·»åŠ "æœªæ‰¾åˆ°"æç¤º
                    const noResultDiv = document.createElement('div');
                    noResultDiv.style.cssText = 'padding: 15px 20px; color: #999; text-align: center; border-bottom: 1px solid rgba(0,0,0,0.05);';
                    noResultDiv.innerHTML = 'æœªæ‰¾åˆ°åŒ¹é…çš„æ¸¸æˆ ğŸ˜•<br><small>å°è¯•ä½¿ç”¨è‹±æ–‡åæˆ–ä¸­æ–‡åæœç´¢</small>';
                    searchResults.appendChild(noResultDiv);



                    // æ˜¾ç¤ºæœ€è¿‘æ¸¸æˆï¼ˆé™åˆ¶å‰5ä¸ªï¼‰
                    recentGames.slice(0, 5).forEach(game => {
                        const div = document.createElement('div');
                        div.className = 'game-item recent-game';
                        div.style.paddingLeft = '25px';

                        const gameInfo = document.createElement('div');
                        gameInfo.style.cssText = 'display: flex; justify-content: space-between; align-items: center;';

                        const nameDiv = document.createElement('div');
                        const displayName = game.chinese === game.name ? game.name : game.chinese;
                        nameDiv.innerHTML = `<span style="color: #888;">ğŸ•’</span> ${displayName}`;
                        nameDiv.style.fontWeight = '500';

                        gameInfo.appendChild(nameDiv);
                        div.appendChild(gameInfo);

                        div.addEventListener('click', function () {
                            selectedGame = game;
                            const displayName = game.chinese === game.name ? game.name : game.chinese;
                            gameSearchInput.value = displayName;
                            searchResults.style.display = 'none';

                            if (modIdInput.value.trim()) {
                                goButton.style.background = 'linear-gradient(45deg, #4CAF50, #45a049)';
                                goButton.textContent = `è·³è½¬åˆ° ${displayName}`;
                            }
                        });

                        searchResults.appendChild(div);
                    });

                    searchResults.style.display = 'block';
                } else {
                    // å®Œå…¨æ²¡æœ‰ç»“æœä¸”æ²¡æœ‰å†å²è®°å½•
                    searchResults.innerHTML = '<div class="game-item" style="color: #999; text-align: center; padding: 20px;">æœªæ‰¾åˆ°åŒ¹é…çš„æ¸¸æˆ ğŸ˜•<br><small>å°è¯•ä½¿ç”¨è‹±æ–‡åæˆ–ä¸­æ–‡åæœç´¢</small></div>';
                    searchResults.style.display = 'block';
                }
            }
        });

        // è®¡ç®—åŒ¹é…åˆ†æ•° - ç”¨äºæœç´¢ç»“æœæ’åº
        function getMatchScore(game, searchTerm) {
            const englishName = game.name.toLowerCase();
            const chineseName = game.chinese.toLowerCase();
            const search = searchTerm.toLowerCase();

            let score = 0;

            // å®Œå…¨åŒ¹é…å¾—åˆ†æœ€é«˜
            if (englishName === search || chineseName === search) score += 100;

            // å¼€å¤´åŒ¹é…å¾—åˆ†é«˜
            if (englishName.startsWith(search) || chineseName.startsWith(search)) score += 50;

            // åŒ…å«åŒ¹é…
            if (englishName.includes(search) || chineseName.includes(search)) score += 30;

            // å•è¯åŒ¹é…
            const englishWords = englishName.split(/[\s\-:]/);
            for (const word of englishWords) {
                if (word.startsWith(search)) score += 20;
                if (word.includes(search)) score += 10;
            }

            return score;
        }

        // é«˜äº®åŒ¹é…æ–‡æœ¬
        function highlightMatch(text, searchTerm) {
            if (!searchTerm || searchTerm.length < 1) return text;

            const regex = new RegExp(`(${searchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
            return text.replace(regex, '<span style="background: rgba(102, 126, 234, 0.2); padding: 1px 3px; border-radius: 3px;">$1</span>');
        }

        // æ ¼å¼åŒ–æ•°å­—æ˜¾ç¤º
        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toLocaleString();
        }

        // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­æœç´¢ç»“æœ
        document.addEventListener('click', function (e) {
            if (e.target !== gameSearchInput && e.target !== searchResults) {
                searchResults.style.display = 'none';
            }
        });

        // è·³è½¬æŒ‰é’®
        goButton.addEventListener('click', function () {
            const modId = modIdInput.value.trim();

            if (!selectedGame) {
                showNotification('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªæ¸¸æˆ', 'warning');
                return;
            }

            if (!modId || isNaN(modId)) {
                showNotification('è¯·è¾“å…¥æœ‰æ•ˆçš„Mod IDï¼ˆæ•°å­—ï¼‰', 'warning');
                return;
            }

            // æ·»åŠ åŠ è½½åŠ¨ç”»
            const originalText = goButton.innerHTML;
            goButton.innerHTML = '<span class="loading"></span> è·³è½¬ä¸­...';
            goButton.disabled = true;

            // æ¨¡æ‹ŸåŠ è½½å»¶è¿Ÿï¼Œå¢åŠ ä½“éªŒæ„Ÿ
            setTimeout(() => {
                const url = `https://www.nexusmods.com/${selectedGame.slug}/mods/${modId}`;
                window.open(url, '_blank');

                // é‡ç½®æŒ‰é’®
                goButton.innerHTML = originalText;
                goButton.disabled = false;

                showNotification('å·²åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€Modé¡µé¢', 'success');
            }, 800);
        });

        // é€šçŸ¥ç³»ç»Ÿ
        function showNotification(message, type = 'info') {
            // åˆ›å»ºé€šçŸ¥å…ƒç´ 
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;

            // æ·»åŠ æ ·å¼
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 25px;
                border-radius: 12px;
                color: white;
                font-weight: 600;
                z-index: 99999;
                transform: translateX(400px);
                transition: all 0.3s ease;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                backdrop-filter: blur(10px);
            `;

            // æ ¹æ®ç±»å‹è®¾ç½®é¢œè‰²
            switch (type) {
                case 'success':
                    notification.style.background = 'linear-gradient(45deg, #4CAF50, #45a049)';
                    break;
                case 'warning':
                    notification.style.background = 'linear-gradient(45deg, #ff9800, #f57c00)';
                    break;
                case 'error':
                    notification.style.background = 'linear-gradient(45deg, #f44336, #d32f2f)';
                    break;
                default:
                    notification.style.background = 'linear-gradient(45deg, #2196F3, #1976D2)';
            }

            document.body.appendChild(notification);

            // åŠ¨ç”»æ˜¾ç¤º
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);

            // è‡ªåŠ¨æ¶ˆå¤±
            setTimeout(() => {
                notification.style.transform = 'translateX(400px)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // æ·»åŠ é”®ç›˜å¿«æ·é”®æ”¯æŒ
        document.addEventListener('keydown', function (e) {
            // Enteré”®å¿«é€Ÿè·³è½¬
            if (e.key === 'Enter' && (e.target === modIdInput || e.target === gameSearchInput)) {
                if (e.target === gameSearchInput && searchResults.style.display === 'block') {
                    // å¦‚æœåœ¨æœç´¢æ¡†ä¸­æŒ‰å›è½¦ä¸”æœ‰æœç´¢ç»“æœï¼Œé€‰æ‹©ç¬¬ä¸€ä¸ª
                    const firstItem = searchResults.querySelector('.game-item');
                    if (firstItem) {
                        firstItem.click();
                    }
                } else {
                    goButton.click();
                }
            }

            // Escapeé”®å…³é—­æœç´¢ç»“æœ
            if (e.key === 'Escape') {
                searchResults.style.display = 'none';
            }
        });

        // æ·»åŠ è¾“å…¥éªŒè¯å’Œå®æ—¶åé¦ˆ
        modIdInput.addEventListener('input', function () {
            const value = this.value.trim();

            // ç§»é™¤éæ•°å­—å­—ç¬¦
            this.value = value.replace(/[^0-9]/g, '');

            // å®æ—¶éªŒè¯
            if (this.value && selectedGame) {
                goButton.style.background = 'linear-gradient(45deg, #4CAF50, #45a049)';
                goButton.textContent = `è·³è½¬åˆ° ${selectedGame.name}`;
            } else {
                goButton.style.background = 'linear-gradient(45deg, #667eea, #764ba2)';
                goButton.textContent = 'è·³è½¬åˆ°Modé¡µé¢';
            }
        });

        // æ·»åŠ ç²’å­æ•ˆæœèƒŒæ™¯
        function createParticles() {
            const particleCount = 50;
            const particles = [];

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.cssText = `
                    position: fixed;
                    width: 4px;
                    height: 4px;
                    background: rgba(255,255,255,0.3);
                    border-radius: 50%;
                    pointer-events: none;
                    z-index: -1;
                `;

                particle.style.left = Math.random() * window.innerWidth + 'px';
                particle.style.top = Math.random() * window.innerHeight + 'px';

                document.body.appendChild(particle);
                particles.push({
                    element: particle,
                    x: Math.random() * window.innerWidth,
                    y: Math.random() * window.innerHeight,
                    vx: (Math.random() - 0.5) * 2,
                    vy: (Math.random() - 0.5) * 2
                });
            }

            function animateParticles() {
                particles.forEach(particle => {
                    particle.x += particle.vx;
                    particle.y += particle.vy;

                    if (particle.x < 0 || particle.x > window.innerWidth) particle.vx *= -1;
                    if (particle.y < 0 || particle.y > window.innerHeight) particle.vy *= -1;

                    particle.element.style.left = particle.x + 'px';
                    particle.element.style.top = particle.y + 'px';
                });

                requestAnimationFrame(animateParticles);
            }

            animateParticles();
        }

        // æ›´æ–°è®¾ç½®å›¾æ ‡çŠ¶æ€
        function updateSettingsIconStatus() {
            const settingsIcon = document.getElementById('settings-icon');
            if (hasApiKey()) {
                settingsIcon.className = 'has-api';
                settingsIcon.title = 'API Key è®¾ç½®ï¼ˆå·²é…ç½® âœ…ï¼‰';
            } else {
                settingsIcon.className = 'no-api';
                settingsIcon.title = 'API Key è®¾ç½®ï¼ˆæœªé…ç½® âš ï¸ï¼‰';
            }
        }

        // API Key æ¨¡æ€æ¡†ç®¡ç†
        function showApiModal() {
            const modal = document.getElementById('api-modal');
            const apiKeyInput = document.getElementById('api-key-input');
            const currentApiKey = getApiKey();

            // å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œä¸åœ¨è¾“å…¥æ¡†ä¸­æ˜¾ç¤ºç°æœ‰çš„API Key
            // ç”¨æˆ·éœ€è¦é‡æ–°è¾“å…¥æˆ–æ¸…é™¤
            apiKeyInput.value = '';
            apiKeyInput.placeholder = currentApiKey ? 'å·²è®¾ç½®API Keyï¼Œè¾“å…¥æ–°çš„Keyæˆ–ç•™ç©ºä¿æŒä¸å˜' : 'è¾“å…¥æ‚¨çš„ Nexus Mods API Key';

            modal.style.display = 'block';
            updateApiKeyStatus();

            // èšç„¦åˆ°è¾“å…¥æ¡†
            setTimeout(() => {
                apiKeyInput.focus();
            }, 300);
        }

        function hideApiModal() {
            const modal = document.getElementById('api-modal');
            modal.style.display = 'none';
        }

        function updateApiKeyStatus() {
            const statusDiv = document.getElementById('api-key-status');
            const apiKey = getApiKey();

            if (!apiKey) {
                statusDiv.innerHTML = '<div class="api-status none">âŒ æœªè®¾ç½® API Key</div>';
            } else if (apiKey.length < 20) {
                statusDiv.innerHTML = '<div class="api-status invalid">âš ï¸ API Key æ ¼å¼å¯èƒ½ä¸æ­£ç¡®</div>';
            } else {
                statusDiv.innerHTML = '<div class="api-status valid">âœ… API Key å·²è®¾ç½®</div>';
            }
        }

        function saveApiKey() {
            const apiKeyInput = document.getElementById('api-key-input');
            const apiKey = apiKeyInput.value.trim();

            if (!apiKey) {
                showNotification('è¯·è¾“å…¥ API Key', 'warning');
                return;
            }

            if (apiKey.length < 20) {
                showNotification('API Key æ ¼å¼ä¼¼ä¹ä¸æ­£ç¡®ï¼Œè¯·æ£€æŸ¥', 'warning');
                return;
            }

            if (setApiKey(apiKey)) {
                showNotification('API Key ä¿å­˜æˆåŠŸï¼', 'success');
                updateApiKeyStatus();
                updateSettingsIconStatus();
                hideApiModal();
                
                // å®‰å…¨æ¸…ç†ï¼šæ¸…ç©ºè¾“å…¥æ¡†å¹¶ç§»é™¤DOMä¸­çš„å€¼
                apiKeyInput.value = '';
                apiKeyInput.setAttribute('value', '');
                
                // å»¶è¿Ÿæ¸…ç†ï¼Œç¡®ä¿æ²¡æœ‰æ˜æ–‡æ®‹ç•™
                setTimeout(() => {
                    apiKeyInput.removeAttribute('value');
                }, 100);

            } else {
                showNotification('ä¿å­˜ API Key å¤±è´¥', 'error');
            }
        }

        function clearApiKeyAndReset() {
            if (clearApiKey()) {
                showNotification('API Key å·²æ¸…é™¤', 'info');
                updateApiKeyStatus();
                updateSettingsIconStatus();
                
                // å®‰å…¨æ¸…ç†è¾“å…¥æ¡†
                const apiKeyInput = document.getElementById('api-key-input');
                apiKeyInput.value = '';
                apiKeyInput.setAttribute('value', '');
                setTimeout(() => {
                    apiKeyInput.removeAttribute('value');
                }, 100);
            } else {
                showNotification('æ¸…é™¤ API Key å¤±è´¥', 'error');
            }
        }



        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('load', async function () {
            createParticles();

            // ç»‘å®šGitHubå›¾æ ‡äº‹ä»¶
            const githubIcon = document.getElementById('github-icon');
            githubIcon.addEventListener('click', function() {
                const githubUrl = 'https://github.com/llxo/nexusmodjumper';
                window.open(githubUrl, '_blank');
                showNotification('æ­£åœ¨æ‰“å¼€ GitHub é¡¹ç›®é¡µé¢ ğŸš€', 'info');
            });

            // ç»‘å®šæ¸…é™¤å†å²å›¾æ ‡äº‹ä»¶
            const clearHistoryIcon = document.getElementById('clear-history-icon');
            clearHistoryIcon.addEventListener('click', function() {
                // ç›´æ¥æ¸…é™¤å†å²è®°å½•ï¼Œæ— éœ€äºŒæ¬¡ç¡®è®¤
                if (clearRecentGames()) {
                    showNotification('å†å²è®°å½•å·²æ¸…é™¤ ğŸ—‘ï¸', 'success');
                    
                    // å¦‚æœå½“å‰æ­£åœ¨æ˜¾ç¤ºæœç´¢ç»“æœï¼Œéšè—å®ƒä»¬
                    const searchResults = document.getElementById('search-results');
                    if (searchResults.style.display === 'block') {
                        searchResults.style.display = 'none';
                    }
                    
                    // æ¸…ç©ºæœç´¢æ¡†
                    const gameSearchInput = document.getElementById('game-search');
                    gameSearchInput.value = '';
                    selectedGame = null;
                    
                    // é‡ç½®æŒ‰é’®çŠ¶æ€
                    goButton.style.background = 'linear-gradient(45deg, #667eea, #764ba2)';
                    goButton.textContent = 'è·³è½¬åˆ°Modé¡µé¢';
                } else {
                    showNotification('æ¸…é™¤å†å²è®°å½•å¤±è´¥', 'error');
                }
            });

            // ç»‘å®šè®¾ç½®å›¾æ ‡äº‹ä»¶
            const settingsIcon = document.getElementById('settings-icon');
            settingsIcon.addEventListener('click', showApiModal);

            // ç»‘å®šæ¨¡æ€æ¡†äº‹ä»¶
            const apiModal = document.getElementById('api-modal');
            const closeModal = document.getElementById('close-modal');
            const cancelModal = document.getElementById('cancel-modal');
            const saveApiKeyBtn = document.getElementById('save-api-key');
            const clearApiKeyBtn = document.getElementById('clear-api-key');
            const apiKeyInput = document.getElementById('api-key-input');

            // å…³é—­æ¨¡æ€æ¡†
            closeModal.addEventListener('click', hideApiModal);
            cancelModal.addEventListener('click', hideApiModal);

            // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
            apiModal.addEventListener('click', function (e) {
                if (e.target === apiModal) {
                    hideApiModal();
                }
            });

            // ä¿å­˜API Key
            saveApiKeyBtn.addEventListener('click', saveApiKey);

            // æ¸…é™¤API Key
            clearApiKeyBtn.addEventListener('click', clearApiKeyAndReset);

            // API Keyè¾“å…¥æ¡†å›è½¦ä¿å­˜
            apiKeyInput.addEventListener('keydown', function (e) {
                if (e.key === 'Enter') {
                    saveApiKey();
                }
                if (e.key === 'Escape') {
                    hideApiModal();
                }
            });

            // API Keyè¾“å…¥å®æ—¶éªŒè¯
            apiKeyInput.addEventListener('input', function () {
                setTimeout(updateApiKeyStatus, 300); // å»¶è¿Ÿæ›´æ–°çŠ¶æ€
            });

            // é˜²æ­¢å¼€å‘è€…å·¥å…·æŸ¥çœ‹API Key
            apiKeyInput.addEventListener('blur', function() {
                // å½“å¤±å»ç„¦ç‚¹æ—¶ï¼Œæ¸…ç†DOMä¸­å¯èƒ½æ®‹ç•™çš„å€¼
                setTimeout(() => {
                    this.removeAttribute('value');
                }, 50);
            });



            // ç»‘å®šåˆ·æ–°å›¾æ ‡äº‹ä»¶
            const refreshIcon = document.getElementById('refresh-icon');

            refreshIcon.addEventListener('click', async function () {
                // å¦‚æœæ­£åœ¨åˆ·æ–°æˆ–ç¦ç”¨çŠ¶æ€ï¼Œä¸å¤„ç†ç‚¹å‡»
                if (refreshIcon.classList.contains('refreshing') || refreshIcon.classList.contains('disabled')) {
                    return;
                }

                const loadingIndicator = document.getElementById('loading-indicator');

                // æ·»åŠ åˆ·æ–°åŠ¨ç”»å’Œç¦ç”¨çŠ¶æ€
                refreshIcon.classList.add('refreshing', 'disabled');

                // æ¸…é™¤ç¼“å­˜å¹¶é‡æ–°æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                clearGamesCache();
                gameSearchInput.disabled = true;
                gameSearchInput.placeholder = 'æ­£åœ¨å¼ºåˆ¶åˆ·æ–°...';
                loadingIndicator.style.display = 'block';

                // å¼ºåˆ¶é‡æ–°è·å–æ¸¸æˆåˆ—è¡¨ï¼ˆè·³è¿‡ç¼“å­˜ï¼‰
                await fetchGamesFromAPI(true);

            });

            // åˆå§‹åŒ–è®¾ç½®å›¾æ ‡çŠ¶æ€
            updateSettingsIconStatus();

            // æ£€æŸ¥API KeyçŠ¶æ€å¹¶æ˜¾ç¤ºæç¤º
            if (!hasApiKey()) {
                setTimeout(() => {
                    showNotification('âš™ï¸ å»ºè®®è®¾ç½® API Key ä»¥è·å–æœ€æ–°æ¸¸æˆåˆ—è¡¨', 'info');
                }, 3000);
            }

            await fetchGamesFromAPI();
        });
    </script>
</body>

</html>